<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>CUPED: Controlled Experiments Utilizing Pre-Experiment Data</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">CUPED: Controlled Experiments Utilizing
Pre-Experiment Data</h1>



<p>CUPED is a method for variance reduction being widely implemented by
major online experimentation platforms (Deng et al. 2013). The idea was
recently extended to a general augmentation framework (Deng et
al. 2023), which is a special case of</p>
<p>Chen, Y.-H., and Chen, H. (2000), A Unified Approach to Regression
Analysis Under Double Sampling Design, <em>Journal of the Royal
Statistical Society, Series B</em>, 62, 449–460.</p>
<p>The extended CUPED is a good application case of
<code>multipleOutcomes</code>. Instead of following Deng’s new paper, I
use Chen’s approach to elaborate on the details of extended CUPED, as
this will better facilitate the explanation of its underlying
assumptions and failure conditions.</p>
<p>Consider a two-arm randomized controlled experiment of a targeted
metric <span class="math inline">\(Y\)</span>. Let <span class="math inline">\(A\)</span> be the arm assignment. If randomization
is successful, the treatment effect can be assessed through <span class="math inline">\(\hat{\Delta}\)</span>, the estimate of <span class="math inline">\(\Delta\)</span> in the linear regression model</p>
<p><span class="math display">\[Y = \alpha + \Delta A +
\text{error},\]</span></p>
<p>where error is unnecessary to be normal. Note that a logistic
regression model may be more appropriate if <span class="math inline">\(Y\)</span> is binary.</p>
<p>Obviously, <span class="math inline">\(\hat{\Delta}\)</span> is
consistent and asymptotic unbiased under good randomization. We are of
interest in alternative estimates for <span class="math inline">\(\Delta\)</span> with variance lower than that of
<span class="math inline">\(\hat{\Delta}\)</span>. Consider an
estimate</p>
<p><span class="math display">\[\tilde{\Delta} = \hat{\Delta} + c \times
\hat{\delta} \]</span> where <span class="math inline">\(\text{E}(\hat{\delta}) = 0\)</span>. Thus, <span class="math inline">\(\tilde{\Delta}\)</span> is also consistent and
asymptotic unbiased to the treatment effect <span class="math inline">\(\Delta\)</span>, and the variance of <span class="math inline">\(\tilde{\Delta}\)</span> is no greater than <span class="math inline">\(\hat{\Delta}\)</span> (worst case: <span class="math inline">\(c=0\)</span>). <strong>As long as <span class="math inline">\(\hat\Delta\)</span> and <span class="math inline">\(\hat\delta\)</span> are correlated, we can find a
<span class="math inline">\(c\)</span> yielding a more efficient
estimate of <span class="math inline">\(\Delta\)</span>.</strong> This
simple idea can be further extended for more than one <span class="math inline">\(\hat\delta\)</span>:</p>
<p><span class="math display">\[\tilde{\Delta} = \hat{\Delta} + c_1
\times \hat\delta_1 + c_2 \times \hat\delta_2 + \cdots + c_K \times
\hat\delta_K.\]</span></p>
<p>To conduct <span class="math inline">\(\hat\delta\)</span> of zero
expectation, one may collect additional pre- or in-experiment metrics
<span class="math inline">\(X_1, X_2, \cdots, X_K\)</span> for each of
the samples. If <span class="math inline">\(X\)</span> are well balanced
in the two arms, we have <span class="math inline">\(\delta_1 = \delta_2
= \cdots = \delta_K = 0\)</span>, where <span class="math inline">\(\delta_k\)</span> is the slope of a working
model</p>
<p><span class="math display">\[X_k = \alpha_k + \delta_k A +
\text{error}.\]</span> Here, a working model means that the relationship
between the variables specified by the model is unnecessarily true; we
simply choose to fit it as is. As a result, the error term can be
anything and an unreasonable link function may be adopted without
affecting the validity of extended CUPED. For example, one can fit a
linear regression against a binary <span class="math inline">\(X\)</span>; the slope <span class="math inline">\(\delta = 0\)</span> as long as <span class="math inline">\(X\)</span> is balanced. Furthermore, note that for
any transformation <span class="math inline">\(h(\cdot)\)</span>, <span class="math inline">\(h(X)\)</span> is balanced given that <span class="math inline">\(X\)</span> is balanced, one can fit the following
working model as well</p>
<p><span class="math display">\[h_k(X_k) = \alpha_k + \delta_k^h A +
\text{error}.\]</span> A more natural model, the logistic regression
model also works</p>
<p><span class="math display">\[\text{logit}\ \text{Pr}(X_k = 1\mid A) =
\alpha_k + \delta_k^\text{logit}A.\]</span> It is interesting that
mutiple <span class="math inline">\(\hat\delta\)</span> that
corresponding to the same <span class="math inline">\(X_k\)</span> can
be integrated into the extended CUPED estimate simultaneously. In the
example above, <span class="math inline">\(\tilde\Delta\)</span> can be
defined as</p>
<p><span class="math display">\[\tilde\Delta = \hat\Delta + c_k
\hat{\delta}_k + c_k^h \hat{\delta}_k^h +
c_k^\text{logit}\hat{\delta}_k^\text{logit} + \hat\delta \text{ based on
other } X\]</span> The variance of this estimate is no greater than an
extended CUPED estimate with less <span class="math inline">\(\hat\delta\)</span> from the same metric <span class="math inline">\(X_k\)</span> (e.g. <span class="math inline">\(\hat\Delta + c_k \hat\delta_k\)</span>).</p>
<div id="conclusions" class="section level2">
<h2>Conclusions</h2>
<p>In summary, the extended CUPED is valid (consistent and asymptotic
unbiased) when</p>
<ul>
<li>arm assignment is randomized (good for <span class="math inline">\(\text{E}(\hat\Delta) = \Delta\)</span>)
<strong>and</strong></li>
<li>pre- and in-experiment metrics are balanced across arms (good for
<span class="math inline">\(\text{E}(\hat\delta)=0\)</span>).</li>
</ul>
<p>The extended CUPED is more efficient when</p>
<ul>
<li>at least one of the pre- or in-experiment metrics is correlated with
the targeted metric <strong>and</strong></li>
<li>the weights <span class="math inline">\(c\)</span> are carefully
picked.</li>
</ul>
<p>The optimal weights <span class="math inline">\(c\)</span> depend on
the covariance matrix of <span class="math inline">\((\hat\Delta,
\hat\delta)\)</span>, not the original observation of <span class="math inline">\((Y, X)\)</span>, thus, tuning on <span class="math inline">\(c\)</span> will not inflate the type I error of
inference. <strong><code>multipleOutcomes</code> can return the
covariance matrix for extended CUPED</strong>.</p>
<p>The extended CUPED remains valid even if</p>
<ul>
<li>the working models for pre- and in-experiment metrics (<span class="math inline">\(X \sim A\)</span>) are mis-specified
<strong>and/or</strong></li>
<li>a pre- or in-experiment metric that is uncorrelated with <span class="math inline">\(Y\)</span> is used in the extended CUPED estimate.
This is a nice property because we don’t have to worry about introducing
too many irrelevant metrics that are unhelpful.</li>
</ul>
<p>In fact, adding multiple <span class="math inline">\(\hat\delta\)</span> based on different
transformations on the same <span class="math inline">\(X_k\)</span>
into the extended CUPED estimate may lower its variance further in some
cases. A variance stabilize transformation may be considered for metrics
of certain parametric families of distributions or highly skewed
metrics.</p>
</div>
<div id="implementation" class="section level2">
<h2>Implementation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## generating data</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(multipleOutcomes)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>genData <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed =</span> <span class="cn">NULL</span>){</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(.<span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="fu">diag</span>(sigma) <span class="ot">&lt;-</span> <span class="fl">1.</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  </span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(n, <span class="at">sigma =</span> sigma)</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>  x[, <span class="dv">1</span>] <span class="co"># pre-experiment data of the targeted metric</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>  x[, <span class="dv">2</span>] <span class="co"># continuous metric</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>  x[, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">abs</span>(x[, <span class="dv">3</span>])) <span class="co"># continuous and skewed metric</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>  x[, <span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x[, <span class="dv">4</span>] <span class="sc">&gt;</span> .<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># binary metric</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, .<span class="dv">5</span>) <span class="co"># 1:1 randomization</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>  </span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>  <span class="co"># y is post-experiment data of the targeted metric</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>  y <span class="ot">&lt;-</span> x[, <span class="dv">5</span>]</span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>  y[a <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> y[a <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">sum</span>(a <span class="sc">==</span> <span class="dv">0</span>), <span class="at">sd =</span> .<span class="dv">1</span>)</span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>  y[a <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> y[a <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">sum</span>(a <span class="sc">==</span> <span class="dv">1</span>), <span class="at">mean =</span> .<span class="dv">1</span>, <span class="at">sd =</span> .<span class="dv">1</span>) <span class="co"># Delta = .1</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>  </span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>  <span class="do">## x5 and x6 are metrics (random noise) but uncorrelated with the targeted metric</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>    y, <span class="at">a =</span> a, </span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>    <span class="at">x1 =</span> x[, <span class="dv">1</span>], <span class="at">x2 =</span> x[, <span class="dv">2</span>], <span class="at">x3 =</span> x[, <span class="dv">3</span>], <span class="at">x4 =</span> x[, <span class="dv">4</span>], </span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a>    <span class="at">x5 =</span> <span class="fu">rnorm</span>(n), <span class="at">x6 =</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, .<span class="dv">5</span>))</span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a>  </span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a>}</span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">1</span>)</span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a><span class="fu">head</span>(dat) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a><span class="co">#&gt;             y a         x1         x2         x3 x4         x5 x6</span></span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a><span class="co">#&gt; 1  0.40263988 0 -0.1619335  0.2817750 -1.2855327  1  0.6414685  0</span></span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a><span class="co">#&gt; 2  0.07511838 0 -0.2599780  0.4563869 -0.5211990  1  1.6552190  1</span></span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a><span class="co">#&gt; 3  0.63327183 0  0.8814712  0.2669605 -1.2488553  0 -0.8596355  0</span></span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a><span class="co">#&gt; 4  1.04650293 1  0.6195346  0.6352780  0.1493731  1  0.6173840  0</span></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a><span class="co">#&gt; 5  0.52152316 0  0.6172003  0.5422494 -1.8662895  0  1.3358366  1</span></span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a><span class="co">#&gt; 6 -0.23932112 0 -0.5193212 -0.5739109  0.2578483  0 -0.5340088  1</span></span>
<span id="cb1-51"><a href="#cb1-51" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span>x4, dat) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span>
<span id="cb1-52"><a href="#cb1-52" tabindex="-1"></a><span class="co">#&gt; x4</span></span>
<span id="cb1-53"><a href="#cb1-53" tabindex="-1"></a><span class="co">#&gt;   0   1 </span></span>
<span id="cb1-54"><a href="#cb1-54" tabindex="-1"></a><span class="co">#&gt; 299 201</span></span>
<span id="cb1-55"><a href="#cb1-55" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb1-57"><a href="#cb1-57" tabindex="-1"></a>  dat <span class="sc">%&gt;%</span> </span>
<span id="cb1-58"><a href="#cb1-58" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>x4, <span class="sc">-</span>x6, <span class="sc">-</span>a) <span class="sc">%&gt;%</span> </span>
<span id="cb1-59"><a href="#cb1-59" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;indicator&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-60"><a href="#cb1-60" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(value)) <span class="sc">+</span> </span>
<span id="cb1-61"><a href="#cb1-61" tabindex="-1"></a>    <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>indicator)</span>
<span id="cb1-62"><a href="#cb1-62" tabindex="-1"></a>)</span>
<span id="cb1-63"><a href="#cb1-63" tabindex="-1"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="do">## function to compute CUPED estimate</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="do">## ...: formulas for each of the metrics</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="do">## family: a vector of family for each of the formulas</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="do">## data: a data frame of experiment data</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>cuped <span class="ot">&lt;-</span> <span class="cf">function</span>(..., family, data){</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">multipleOutcomes</span>(..., <span class="at">family =</span> family, <span class="at">data =</span> data, <span class="at">data_index =</span> <span class="cn">NULL</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  id <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fit<span class="sc">$</span>id_map, <span class="cf">function</span>(x){x[<span class="st">&#39;a&#39;</span>]})</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  id1 <span class="ot">&lt;-</span> id[<span class="dv">1</span>]</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  id2 <span class="ot">&lt;-</span> id[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  Delta <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[id1]</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[id2]</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  mcov <span class="ot">&lt;-</span> <span class="fu">vcov</span>(fit)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  opt_c <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="sc">-</span> <span class="fu">solve</span>(mcov[id2, id2, <span class="at">drop =</span> <span class="cn">FALSE</span>]) <span class="sc">%*%</span> mcov[id2, id1, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  </span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>  estimate <span class="ot">&lt;-</span> Delta <span class="sc">+</span> <span class="fu">sum</span>(delta <span class="sc">*</span> opt_c)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>  stderr <span class="ot">&lt;-</span> (</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>    mcov[id1, id1] <span class="sc">+</span> </span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(opt_c) <span class="sc">%*%</span> mcov[id2, id1, <span class="at">drop =</span> <span class="cn">FALSE</span>]) <span class="sc">+</span> </span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>    <span class="fu">as.vector</span>(<span class="fu">t</span>(opt_c) <span class="sc">%*%</span> mcov[id2, id2, <span class="at">drop =</span> <span class="cn">FALSE</span>] <span class="sc">%*%</span> opt_c)</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">sqrt</span>()</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>  </span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">estimate =</span> estimate, <span class="at">stderr =</span> stderr)</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="an-example" class="section level2">
<h2>An Example</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="do">## An example</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="do">## y ~ a: treatment effect of post-experiment data for the targeted metric</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="do">## x1 ~ a: delta (= 0) using pre-experiment data for the targeted metric</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="do">## x2 ~ a: delta (= 0) using a continuous pre-experiment metric</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="do">## x3 ~ a: delta (= 0) using a skewed pre-experiment metric</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="do">## abs(x3) ~ a: delta (= 0) using a transformation of a pre-experiment metric</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="do">## x4 ~ a: delta (= 0) using a binary pre-experiment metric</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="do">## x5 ~ a: delta (= 0) using a metric that is a random noise</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="do">## family: linear regression model is fitted for all working models (even if x4 is binary)</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>cuped_fit <span class="ot">&lt;-</span> </span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  <span class="fu">cuped</span>(</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>    y <span class="sc">~</span> a, </span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    x1 <span class="sc">~</span> a, </span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>    x2 <span class="sc">~</span> a, </span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>    x3 <span class="sc">~</span> a, </span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>    <span class="fu">abs</span>(x3) <span class="sc">~</span> a, </span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    x4 <span class="sc">~</span> a, </span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>    x5 <span class="sc">~</span> a, </span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&#39;gaussian&#39;</span>, </span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>    <span class="at">data =</span> dat)</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="do">## CUPED estimate and its standard error</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="fu">print</span>(cuped_fit)</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt; $estimate</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt; [1] 0.06196927</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt; $stderr</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt; [1] 0.05886572</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="do">## treatment effect on targeted metric (post-experiment data only)</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> a, dat))<span class="sc">$</span>coef</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt;                Estimate Std. Error    t value  Pr(&gt;|t|)</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.11394931 0.06572757  1.7336608 0.0835972</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co">#&gt; a           -0.03789196 0.09221800 -0.4108955 0.6813259</span></span></code></pre></div>
<p>The example above illustrates a complex case of CUPED using
<code>mutipleOutcomes</code>. The standard error of estimated treatment
effect is substantially reduced (0.059 vs 0.092).</p>
</div>
<div id="simulation" class="section level2">
<h2>Simulation</h2>
<p>We carry out simulations to verify the key points in Conclusions.
Specifically,</p>
<ul>
<li>adding more metrics with zero expectation can reduce variance;</li>
<li>adding noise does not hurt the efficiency;</li>
<li>if all added metrics are noise, CUPED is equivalent to using
post-data only.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>n_simu <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>all_estimate <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>all_stderr <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_simu){</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">genData</span>(i)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="co"># use post- data only</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  post_only <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> a, dat))<span class="sc">$</span>coef</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  </span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="co"># add pre- data of targeted metric</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  pre_target <span class="ot">&lt;-</span> <span class="fu">cuped</span>(y <span class="sc">~</span> a, x1 <span class="sc">~</span> a, <span class="at">family =</span> <span class="st">&#39;gaussian&#39;</span>, <span class="at">data =</span> dat)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  </span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="co"># add more pre- data</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  pre_more <span class="ot">&lt;-</span> <span class="fu">cuped</span>(y <span class="sc">~</span> a, x1 <span class="sc">~</span> a, x3 <span class="sc">~</span> a, x4 <span class="sc">~</span> a, <span class="at">family =</span> <span class="st">&#39;gaussian&#39;</span>, <span class="at">data =</span> dat)</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  </span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="co"># multiple delta (transformation) for the same metric</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="co"># transform_delta &lt;- cuped(y ~ a, x1 ~ a, x3 ~ a, exp(x3) ~ a, x4 ~ a, x4 ~ a, family = c(&#39;gaussian&#39;, &#39;gaussian&#39;, &#39;gaussian&#39;, &#39;gaussian&#39;, &#39;gaussian&#39;, &#39;binomial&#39;), data = dat)</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  </span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>  <span class="co"># add all correlated pre- data</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  all_corr <span class="ot">&lt;-</span> <span class="fu">cuped</span>(y <span class="sc">~</span> a, x1 <span class="sc">~</span> a, x2 <span class="sc">~</span> a, x3 <span class="sc">~</span> a, x4 <span class="sc">~</span> a, <span class="at">family =</span> <span class="st">&#39;gaussian&#39;</span>, <span class="at">data =</span> dat)</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>  </span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>  <span class="co"># add noise data</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  add_noise <span class="ot">&lt;-</span> <span class="fu">cuped</span>(y <span class="sc">~</span> a, x1 <span class="sc">~</span> a, x2 <span class="sc">~</span> a, x3 <span class="sc">~</span> a, x4 <span class="sc">~</span> a, x5 <span class="sc">~</span> a, x6 <span class="sc">~</span> a, <span class="at">family =</span> <span class="st">&#39;gaussian&#39;</span>, <span class="at">data =</span> dat)</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>  </span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>  <span class="co"># noise only</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>  noise_only <span class="ot">&lt;-</span> <span class="fu">cuped</span>(y <span class="sc">~</span> a, x5 <span class="sc">~</span> a, x6 <span class="sc">~</span> a, <span class="at">family =</span> <span class="fu">c</span>(<span class="st">&#39;gaussian&#39;</span>, <span class="st">&#39;gaussian&#39;</span>, <span class="st">&#39;binomial&#39;</span>), <span class="at">data =</span> dat)</span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>  </span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>  extractEstimate <span class="ot">&lt;-</span> <span class="cf">function</span>(mod){</span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>    mod<span class="sc">$</span>estimate</span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>  }</span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>  </span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>  extractStderr <span class="ot">&lt;-</span> <span class="cf">function</span>(mod){</span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a>    mod<span class="sc">$</span>stderr</span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a>  }</span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>  </span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>  estimate <span class="ot">&lt;-</span> </span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>      <span class="at">post_only =</span> post_only[<span class="st">&#39;a&#39;</span>, <span class="st">&#39;Estimate&#39;</span>], </span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a>      <span class="at">pre_target =</span> <span class="fu">extractEstimate</span>(pre_target), </span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a>      <span class="at">pre_more =</span> <span class="fu">extractEstimate</span>(pre_more), </span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a>      <span class="co"># transform_delta = extractEstimate(transform_delta), </span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a>      <span class="at">all_corr =</span> <span class="fu">extractEstimate</span>(all_corr), </span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a>      <span class="at">add_noise =</span> <span class="fu">extractEstimate</span>(add_noise), </span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a>      <span class="at">noise_only =</span> <span class="fu">extractEstimate</span>(noise_only)</span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a>    )</span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a>  </span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a>  stderr <span class="ot">&lt;-</span> </span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a>      <span class="at">post_only =</span> post_only[<span class="st">&#39;a&#39;</span>, <span class="st">&#39;Std. Error&#39;</span>], </span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a>      <span class="at">pre_target =</span> <span class="fu">extractStderr</span>(pre_target), </span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a>      <span class="at">pre_more =</span> <span class="fu">extractStderr</span>(pre_more), </span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a>      <span class="co"># transform_delta = extractStderr(transform_delta), </span></span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a>      <span class="at">all_corr =</span> <span class="fu">extractStderr</span>(all_corr), </span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a>      <span class="at">add_noise =</span> <span class="fu">extractStderr</span>(add_noise), </span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a>      <span class="at">noise_only =</span> <span class="fu">extractStderr</span>(noise_only)</span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a>    )</span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a>  </span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a>  all_estimate <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_estimate, estimate)</span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a>  all_stderr <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_stderr, stderr)</span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a></span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a>}</span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a></span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a><span class="do">## mean of estimates of simulation (true Delta = .1)</span></span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a><span class="fu">apply</span>(all_estimate, <span class="dv">2</span>, mean) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a><span class="co">#&gt;  post_only pre_target   pre_more   all_corr  add_noise noise_only </span></span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a><span class="co">#&gt;      0.101      0.100      0.101      0.101      0.101      0.102</span></span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a></span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a><span class="do">## empirical standard deviation</span></span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a><span class="fu">apply</span>(all_estimate, <span class="dv">2</span>, sd) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a><span class="co">#&gt;  post_only pre_target   pre_more   all_corr  add_noise noise_only </span></span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a><span class="co">#&gt;     0.0916     0.0654     0.0627     0.0585     0.0585     0.0918</span></span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a></span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a><span class="do">## theoretical standard error</span></span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a><span class="fu">apply</span>(all_stderr, <span class="dv">2</span>, mean) <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a><span class="co">#&gt;  post_only pre_target   pre_more   all_corr  add_noise noise_only </span></span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a><span class="co">#&gt;     0.0898     0.0643     0.0617     0.0576     0.0575     0.0896</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
